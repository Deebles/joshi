Code following the seminal texctby Mark Joshi
